## 1. 初始化块定义

**初始化块**是Java类里可出现的第4种成员（成员变量、方法、构造器、初始化块），一个类里可以有多个初始化块，相同类型的初始化块之间有顺序，按照定义的先后顺序执行。

定义语法：

```java
[static] {
    // 初始化块的可执行性代码
    …
}
```

初始化块的修饰符要么是static要么没有，分别称为

- **静态/类初始化块**
- **非静态/普通初始化块**。

初始化块虽然也是Java类的一种成员，但它没有名字（标识），因而无法通过类、对象来调用初始化块。

## 2. 非静态初始化块

非静态初始化块只在创建Java对象时隐式执行，而且在执行构造器之前执行。

虽然Java允许一个类里定义多个非静态初始化块，但这没有意义，因为初始化块是在创建Java对象时隐式执行的，而且它们总是全部执行，因此完全可以把多个普通初始化块合并成一个初始化块，让程序更加简洁。

### 非静态初始化块 v.s. 构造方法

（普通）初始化块和构造器的作用非常相似，它们都用于对Java对象执行指定的初始化操作，但也有稍许不同：

- 非静态初始化块、声明实例变量指定的默认值都可认为是对象的初始化代码，它们的执行顺序与源程序中的排列顺序相同。
- 当Java创建一个对象时，系统先为该对象的所有实例变量分配内存（前提是该类已经被加载过了），然后程序开始对这些实例变量执行初始化。其初始化顺序是：
    1. 顺序执行初始化块或声明实例变量时指定的初始值
    2. 执行构造器里指定的初始值。
- 与构造方法类似，创建Java对象时不仅会执行该类的普通初始化块和构造器，而且系统会一直上溯到java.lang.Ojbect类，先执行java.lang.Object类的初始化块，然后执行java.lang.Objet的构造器，依次类推。

实际上初始化块是一个假象，使用javac命令编译Java类后，该Java类中的初始化块会消失——初始化块中代码会被“还原”到每个构造器中，且位于构造器所有代码的前面。<font color="red">（初始化块是个假象，还是非静态初始化块是个假象？？？）</font>

<img src="https://chua-n.gitee.io/blog-images/notebooks/Java/31.png" alt="31" style="zoom:67%;" />

## 3. 静态初始化块

> 普通初始化块负责对对象进行初始化，类初始化块负责对类进行初始化。

static初始化块属于类的静态成员，是类相关的，系统将在类初始化阶段执行静态初始化块，而不是在创建对象时才执行，故而静态初始化块总是比普通初始化块先执行。

static初始化块成功执行一次后，意味着该类初始化完成，后边再次创建该类实例时便不会再调用static初始化块。

static初始化块同样是上溯到java.lang.Object类，先执行顶层、再执行当前类的static初始化块。

static初始化块和声明静态成员变量时所指定的初始值都是该类的初始化代码，它们的执行顺序与源程序中的排列顺序相同。

当JVM第一次主动使用一个类时，系统会在准备阶段为该类的所有静态成员变量分配内存；在初始化阶段则负责初始化这些静态成员变量。

