## 1. 场景

SpringMVC默认已经提供了一些常用的类型转换器，例如客户端提交的参数总是字符串类型，SpringMVC可以将数字自动转换成int类型。

然而并不提所有的数据类型都提供了转换器，没有提供的就需要自定义了。例如，不同风格的日期类型的数据就需要自定义转换器。

- 业务方法

    ```java
    @RequestMapping("/quick11")
    @ResponseBody
    public void save11(Date date) {
        System.out.println(date);
    }
    ```

- 默认类型转换器

    - 地址栏：  http://localhost/quick11?date=2021/02/17  
    - 输出结果：  Wed Feb 17  00:00:00 CST 2021  

- 这种格式的字符串无法转换

    - 地址栏：http://localhost/quick11?date=2021-02-17
    - 结果：HTTP状态 400 - 错误的请求

## 2. 自定义类型转换器

自定义类型转换器的开发步骤：

1. 定义转换器类，实现Converter接口；
2. 在spring-mvc.xml配置文件中声明转换器；
3. 在<annotation-driven>中引用转换器。

示例：

- DataConverter.java

    ```java
    package com.itheima.converter;
    
    import org.springframework.core.convert.converter.Converter;
    import java.text.ParseException;
    import java.text.SimpleDateFormat;
    import java.util.Date;
    public class DateConverter implements Converter<String, Date> {
        @Override
        public Date convert(String dateStr) {
            // 将日期字符串转换成真正的日期对象并返回
            SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
            Date date = null;
            try {
                date = format.parse(dateStr);
            } catch (ParseException e) {
                e.printStackTrace();
            }
            return date;
        }
    }
    ```

- spring-mvc.xml

    ```xml
    <!--  配置mvc的注解驱动  -->
    <mvc:annotation-driven conversion-service="conversionService"/>
    <!--  声明转换器  -->
    <bean id="conversionService" class="org.springframework.context.support.ConversionServiceFactoryBean">
        <property name="converters">
            <list>
                <bean class="com.itheima.converter.DateConverter"/>
            </list>
        </property>
    </bean>
    ```

- 结果:

    - 解析成功：
        - 地址栏：http://localhost/quick11?date=2021-02-17
        - 结果：Wed Feb 17 00:00:00 CST 2021
    - 原来的反而不能再解析了：
        - 地址栏：http://localhost/quick11?date=2021/02/17
        - 结果：  控制台报错……  

