## 登录校验流程

通常而言，一个系统的登录校验流程可用下图表示：

<img src="../../resources/images/notebook/JavaWeb/SpringSecurity/image-20230215231337620.png" alt="image-20230215231337620" style="zoom:50%;" />

## 入门案例认证流程

![image-20230131134649111](../../resources/images/notebook/JavaWeb/SpringSecurity/image-20230131134649111.png)

- `Authentication`接口：表示当前访问系统的用户，实现类中封装了用户相关信息
- `AuthenticationManager`接口：定义了认证的方法
- `UserDetailsService`接口：加载用户特定数据的核心接口。里面定义了一个根据用户名查询用户信息的方法
- `UserDetails`接口：提供核心用户信息。通过`UserDetailsService`根据用户名获取要处理的用户信息，并封装成`UserDetails`对象返回，然后将这些信息封装到`Authentication`对象中。

## 一个自定义认证方案

登录：

- 自定义登录接口：调用`ProviderManager`的方法进行认证，如果认证通过生成jwt，同时把用户信息存入redis中
- 自定义`UserDetailsService`，在其中查询数据库来获取用户信息

校验：

- 定义jwt认证过滤器：获取token、解析token获取其中的userId、从redis中获取用户信息、存入`SecurityContextHolder`

