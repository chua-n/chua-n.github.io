## 1. 编辑器

Linux 中常用的编辑器有：

-   vim
-   nano
-   emacs
-   KDE series
-   GNOME

GNOME 项目为程序员提供了一个简单的文本编辑器 gedit，Unity 桌面环境都带有 gedit，它是一个基本的文本编辑器，同时提供了一些高级功能，如代码高亮和行编号，开发人员还开发了更多高级插件，如一个拼写检查器、一个终端仿真器、一个文件浏览器。

## 2. vim 文本编辑器

> 在 LINUX 中一切都是文件，而配置一个服务就是在修改其配置文件的参数。

每次运 Vim 编辑器时默认进入**命令模式**，此时需要先切换到**输入模式**后再进行文档编写工作，而每次编写完文档后需要先返回命令模式，然后再进入**末行模式**，执行文档的保存或退出操作。在 Vim 中，无法直接从输入模式切换到末行模式。Vim 的三种模式如下：

<img src="https://chua-n.gitee.io/blog-images/notebooks/杂技/Linux/30.png" style="zoom:67%;" />

-   命令模式：控制光标移动，可对文本进行复制、粘贴、删除和查找等工作
-   输入模式：正常的文本录入
-   末行模式：保存或退出文档，以及设置编辑环境，还可以让用户执行外部的 LINUX 命令或跳转到所编写文档的特定行数

从命令模式切换到输入模式的`a\i\o键`不完全相同，a 键与 i 键分别是在光标后面一位和光标当前位置切换到输入模式，而 o 键则是在光标的下面再创建一个空行，此时可敲击 a 键进入到编辑器的输入模式。

**命令模式**中最常用的一些命令：

| 命令 | 作用                                           |
| ---- | ---------------------------------------------- |
| dd   | 删除（剪切）光标所在整行                       |
| 5dd  | 删除（剪切）从光标处开始的 5 行                |
| yy   | 复制光标所在整行                               |
| 5yy  | 复制从光标处开始的 5 行                        |
| n    | 显示搜索命令定位到的下一个字符串               |
| N    | 显示搜索命令定位到的上一个字符串               |
| u    | 撤销上一步的操作                               |
| p    | 将之前删除(dd)或复制(yy)过的数据粘贴到光标后面 |

**末行模式**中可用的命令：

| 命令          | 作用                                    |
| ------------- | --------------------------------------- |
| :w            | 保存                                    |
| :q            | 退出                                    |
| :q!           | 强制退出（放弃对文档的修改内容）        |
| :wq!          | 强制保存退出                            |
| :set nu       | 显示行号                                |
| :set nonu     | 不显示行号                              |
| :命令         | 执行该命令                              |
| :整数         | 跳转到该行                              |
| :s/one/two    | 将当前光标所在行的第一个 one 替换成 two |
| :s/one/two/g  | 将当前光标所在行的所有 one 替换成 two   |
| :%s/one/two/g | 将全文中的所有 one 替换成 two           |
| ?字符串       | 在文本中从下至上搜索该字符串            |
| /字符串       | 在文本中从上至下搜索该字符串            |

## 3. shell 基操

Shell 终端解释器作为用户与 LINUX 系统内部的通信媒介，除了支持各种变量与参数外，还提供了诸如循环、分支等高级编程语言才有的控制结构特性。

Shell 命令的工作方式有两种：

1. 交互式(Interactive)——用户每输入一条命令就立即执行；

2. 批处理(Batch)——由用户事先编写好一个完整的 SHELL 脚本，SHELL 会一次性执行脚本中诸多的命令。

Shell 脚本文件的名称可以任意，但为了避免被误以为是普通文件，最好将.sh 后缀加上，以表示是一个脚本文件。以下为一个简单的脚本编写内容，其中第一行的脚本声明（#!）用来告诉系统使用哪种 SHELL 解释器来执行该脚本，第二行的注释信息（#）是对脚本功能和某些命令的介绍信息，第三、四行的可执行语句也就是我们平时执行的 Linux 命令了。

| 脚本内容                                                | 执行脚本                                                |
| ------------------------------------------------------- | ------------------------------------------------------- |
| ![](https://chua-n.gitee.io/blog-images/notebooks/杂技/Linux/31.png) | ![](https://chua-n.gitee.io/blog-images/notebooks/杂技/Linux/32.png) |

执行脚本可用`bash <example.sh>`或输入完整路径`./example.sh`，不过后一种默认会因权限不足而提示错误，此时只要为脚本文件增加执行权限即可。

SHELL 脚本中的条件测试语法可以判断表达式是否成立，若条件成立则返回数字 0，否则返回其他随机数值。切记，**条件表达式**两边均应有一个空格。

![](https://chua-n.gitee.io/blog-images/notebooks/杂技/Linux/33.png)

按照测试对象来划分，条件测试语句可分为文件测试、逻辑测试、整数值比较、字符串比较语句。其中，文件测试所用的参数为：

| 运算符 | 作用                       |
| ------ | -------------------------- |
| -d     | 测试文件是否为目录类型     |
| -e     | 测试文件是否存在           |
| -f     | 判断是否为一般文件         |
| -r     | 测试当前用户是否有权限读取 |
| -w     | 测试当前用户是否有权限写入 |
| -x     | 测试当前用户是否有权限执行 |

用 `echo $?` 可显示`$?`变量的值，`$?`是 SHELL 解释器内置的表示上一条命令执行后的返回值的变量。

一些运算符：

| 逻辑符 | 符号 | 整数比较       | 符号 | 字符串比较             | 符号 |
| ------ | ---- | -------------- | ---- | ---------------------- | ---- |
| 与     | &&   | 是否等于       | -eq  | 比较字符串内容是否相同 | =    |
| 或     | \|\| | 是否不等于     | -ne  | 比较字符串内容是否不同 | !=   |
| 非     | !    | 是否大于       | -gt  | 判断字符串内容是否为空 | -z   |
|        |      | 是否大于       | -lt  |                        |      |
|        |      | 是否等于或小于 | -le  |                        |      |
|        |      | 是否大于或等于 | -ge  |                        |      |

## 4. shell 字符串

字符串可以用单引号和双引号，也可以不用引号。

-   单引号：`str='this is a string'`，单引号里的任何字符都会原样输出，也就是说单引号字符串中的变量是无效的；

-   双引号：

    ```bash
    $ your_name='runoob'
    $ str="Hello, I know you are \"$your_name\"! \n"
    $ echo -e $str
    Hello, I know you are "runoob"!
    ```

    -   双引号里可以有变量
    -   双引号里可以出现转义字符

不被引号包围的字符串：

1. 不被引号包围的字符串中出现变量时也会被解析，这一点和双引号" "包围的字符串一样；
2. 字符串中不能出现空格，否则空格后边的内容会被解析为其他变量或命令。

多个字符串直接放在一起时表示字符串拼接（类似 python 的语法）:

```bash
your_name="runoob"
# 使用双引号拼接
greeting="hello, "$your_name" !"
greeting_1="hello, ${your_name} !"
echo $greeting  $greeting_1
# 使用单引号拼接
greeting_2='hello, '$your_name' !'
greeting_3='hello, ${your_name} !'
echo $greeting_2  $greeting_3
```

```text
hello, runoob ! hello, runoob !
hello, runoob ! hello, ${your_name} !
```

获取字符串长度：

```bash
string="abcd"
echo ${#string} # 输出 4
```

## 5. 流程控制语句

-   if 语句

    -   单分支

        ```shell
        if 条件测试操作
          then 命令序列
        fi
        ```

    -   双分支

        ```shell
        if 条件测试操作
          then 命令序列1
          else 命令序列2
        fi
        ```

    -   多分支

        ```shell
        if 条件测试操作1
          then 命令序列1
        elif 条件测试操作2
          else 命令序列2
        else
          命令序列3
        fi
        ```

-   for 条件循环

    ```shell
    for 变量名 in 取值列表
    do
      命令序列
    done
    ```

-   while 条件循环

    ```shell
    while 条件测试操作
    do
      命令序列
    done
    ```

-   case 条件测试语句

    ```shell
    case 变量值 in
    模式1)
      命令序列1
      ;;
    模式2)
      命令序列2
      ;;
      ......
    *)
      默认命令序列
    esac
    ```

## 6. 计划任务

计划任务分为**一次性计划任务**与**长期性计划任务**

1. 一次性：今晚 11 点 30 分开启网站服务

2. 长期性：每周一的凌晨 3 点 25 分把/home/wwwroot 目录打包备份为 backup.tar.gz

at 命令与 crond 服务：

| 命令       | 作用                               | 用户          |
| ---------- | ---------------------------------- | ------------- |
| at         | 设置一次性计划任务                 | at 时间       |
| at -l      | 查看已设置好但还未执行的一次性任务 |               |
| atrm       | 删除某一次性计划任务               | atrm 任务序号 |
| crontab -e | 创建、编辑长期计划任务             |               |
| crontab -l | 删除某条计划任务                   |               |

部署计划任务的时间格式为“分、时、日、月、星期 命令”，若某些字段没有设置，使用星号`*`占位：

<img src="https://chua-n.gitee.io/blog-images/notebooks/杂技/Linux/34.png" style="zoom:50%;" />

计划任务中的“分”字段必须有数值，绝对不能为空或为\*号，而“日”和“星期”字段不能同时使用，否则就会发生冲突。
