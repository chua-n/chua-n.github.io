## 傅里叶变换和卷积

用傅里叶级数或变换表示的函数特征完全可以通过傅里叶反变换来重建，且不会丢失任何信息，这是这种表示方法的最重要特征之一。

**傅里叶级数**——具有周期$T$的连续变量$t$的周期函数$f(t)$可描述为乘以适当系数的正弦和余弦之和，这个和就是傅里叶级数。

| 傅里叶级数                                                   | 欧拉公式                                   |
| ------------------------------------------------------------ | ------------------------------------------ |
| $$f(t)=\sum_{n=-\infty}^{\infty} c_{n} e^{j \frac{2 \pi n}{T} t}, n=0, \pm 1, \pm 2, \ldots\\其中,c_{n}=\frac{1}{T} \int_{-T / 2}^{T / 2} f(t) e^{-j \frac{2 \pi n}{T} t} d t$$ | $$e^{j \theta}=\cos \theta+j \sin \theta$$ |

设连续变量t和μ，有连续函数f(t)的**傅里叶变换对**为

| 傅里叶变换                                                   | 傅里叶反变换                                                 |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| $$F(\mu)=\int_{−\infty}^{\infty}f(t)e^{−j2{\pi}{\mu}t}\mathrm{d}t$$ | $$f(t)=\int_{−\infty}^{\infty}F(\mu)e^{j2{\pi}{\mu}t}\mathrm{d}\mu$$ |

因为$f(t)$的傅里叶变换 $\mathfrak{J}\{f(t)\}=F(\mu)=\int_{-\infty}^{\infty} f(t) e^{-j 2 \pi \mu t} d t=\int_{-\infty}^{\infty} f(t)[\cos (2 \pi \mu t)-j \sin (2 \pi \mu t)] d t$ 积分后，左边剩下的唯一变量是频率$μ$，故称傅里叶变换域是**频率域**。其中，当变量$t$用于图像时，将变量$t$的域称为**空间域**。

**两个函数的卷积**相当于一个函数关于原点旋转180°然后滑过另一个函数，在滑动过程中的每一个位移处，执行相应计算。连续变量t的两个连续函数f(t)和h(t)的卷积公式为：
$$
f(t)⊛h(t)=\int_{−∞}^∞f(τ)h(t−τ)dτ
\\
其中，负号表示翻转180\degree，t是一个函数滑过另一个函数的位移，τ是积分假变量
$$
**卷积定理**：

| $$f(t)⊛h(t)⇔H(μ)F(μ)$$ | $$f(t)h(t)⇔H(μ)⊛F(μ)$$ |
| ---------------------- | ---------------------- |

1. 空间域中两个函数的卷积的傅里叶变换，等于两个函数的傅里叶变换在频率域中的乘积；换句话说，如果有两个傅里叶变换的乘积，那么可以通过计算傅里叶反变换得到空间域的卷积。即，$f(t)⊛h(t)$和$H(μ)F(μ)$是傅里叶变换对：$$f(t)⊛h(t)⇔H(μ)F(μ)$$
2. 频率域的卷积类似于空间域的乘积，两者分别与傅里叶正、反变换相联系。即， $$f(t)h(t)⇔H(μ)⊛F(μ)$$

卷积定理是频率域滤波的基础。

## 冲激与取样

用计算机处理前连续函数必须转换为离散序列，故就需要利用冲激来进行**取样量化**。

冲激及其取样特性（线性变换和傅里叶变换的核心）

- 对于连续变量$t$

    - 连续变量$t$在$t=0$处的单位冲激表示为$δ(t)$
        $$
        \delta(t)=\left\{\begin{array}{ll}\infty, & t=0 \\ 0, & t \neq 0\end{array}\right. 
        \\
        \\
        \int_{-\infty}^{\infty} \delta(t) d t=1
        $$

        > 物理上，如果我们把$t$解释为时间，那么一个冲激可视为幅度无限、持续时间为0、具有单位面积的尖峰信号

    - 连续变量的冲激具有如下**取样特性**

        - 取样特性：$$\sum_{x=-\infty}^{\infty} f(x) \delta(x)=f(0)$$
        - 一般化的取决特性：$$\sum_{x=-\infty}^{\infty} f(x) \delta\left(x-x_{0}\right)=f\left(x_{0}\right)$$

- 对于离散变量$x$

    ![](../../resources/images/notebook/杂技/CV/29.png)

    - **单位离散冲激**$δ(x)$在离散系统中的作用与连续变量相同

        | $$\delta(x)=\left\{\begin{array}{ll}1, & x=0 \\ 0, & x \neq 0\end{array}\right.$$ | $$\sum_{-\infty}^{\infty}\delta(x)=1$$ |
        | ------------------------------------------------------------ | -------------------------------------- |

    - 离散变量的**取样特性**

        | 取样特性                                                     | 一般化地用位置$x=x_0$处的离散冲激                            |
        | ------------------------------------------------------------ | ------------------------------------------------------------ |
        | $$\sum_{x=-\infty}^{\infty} f(x) \delta\left(x\right)=f\left(0\right)$$ | $$\sum_{x=-\infty}^{\infty} f(x) \delta\left(x-x_{0}\right)=f\left(x_{0}\right)$$ |

    - **冲激串**$s_{\Delta T}(t)$：定义为无限多个离散的周期冲激单元$ΔT$之和
        $$
        s_{\Delta T}(t)=\sum_{n=-\infty}^{\infty} \delta(t-n \Delta T)
        $$

对一个连续函数$f(t)$，假设函数关于$t$从$−∞$扩展到$∞$，我们希望以自变量$t$的均匀间隔$ΔT$来取样。可利用一个$ΔT$单位间隔的冲激串作为取样函数去乘以$f(t)$，得取样后的函数$\tilde{f}(t)$，即
$$
\tilde{f}(t)=f(t) s_{\Delta T}(t)=\sum_{n=-\infty}^{\infty} f(t) \delta(t-n \Delta T)=f(n \Delta T), \quad n \in \mathbb{Z}
$$
和式中每一分量都是该冲激位置处$f(t)$的值加权后的冲激，即每个取样值由加权后的冲激强度给出。

![](../../resources/images/notebook/杂技/CV/30.png)

取样函数$\tilde{f}(t)$的傅里叶变换$\mathfrak{J}\{f(t)\}$为：
$$
\tilde{F}(\mu)=\mathfrak{\Im}\{\tilde{f}(t)\}=\mathfrak{\Im}\left\{f(t) s_{\Delta T}(t)\right\}=F(\mu) \circledast S(\mu)=\frac{1}{\Delta T} \sum_{n=-\infty}^{\infty} F\left(\mu-\frac{n}{\Delta T}\right)
$$
上式表明，傅里叶变换$\tilde{F}(\mu)$是$F(μ)$的一个副本的无限、周期序列，也是原始连续函数的傅里叶变换。副本间的间隔由$\frac{1}{ΔT}$ 的值决定。虽然$\tilde{f}(t)$是取样后的函数，但其变换$\tilde{F}(\mu)$是连续的，因为它由$F(μ)$的若干副本组成。

![](../../resources/images/notebook/杂技/CV/31.png)

### 取样定理

![](../../resources/images/notebook/杂技/CV/32.png)设某函数$f(t)$与其傅里叶变换$F(μ)$，若$F(μ)$在以原点为中心的有限区间（带宽）$[−μ_{max},μ_{max} ]$之外均为零，则称函数$f(t)$为带限函数。

对于一个连续带限函数$f(t)$，若取样率大于$2μ_{max}$，在$f(t)$能完全由其样本集进行恢复，这就是所谓的**取样定理**。其中$2μ_{max}$ 称为奈奎斯特取样率。

基于取样定理，若一个连续带限函数用取样率大于函数最高频率两倍的取样来表示，则不会有信息损失；反之，以 $\frac{1}{ΔT}$ 的取样率对一个信号取样的最大频率是$\mu_{max}=\frac{1}{2ΔT}$ 。

### 频率混淆

![](../../resources/images/notebook/杂技/CV/34.png)

如果以低于奈奎斯特取样率取样，会产生周期重叠，且不管使用什么滤波器都无法分隔出变换的单个周期。

由函数欠取样导致的频率破坏就是**频率混淆**，简称为**混淆**。混淆是一个过程，在这一过程中，连续函数的高频成分在取样后的函数中被低频“化妆”了。

遗憾的是，除了某些特殊情况，在取样后的函数中混淆总是存在的。

## 离散傅里叶变换和卷积

离散傅里叶变换（Discrete Fourier Transformation, **DFT**）与离散傅里叶反变换（Inverse DFT, **IDFT**）。

如果$f(x)$由函数$f(t)$以$ΔT$为单位间隔取样后的$M$个样本组成，对于集合${f(x)|x=0,1,…,M−1}$，有其：

- 取样的持续时间：$T=MΔT$
- 频率分辨率（间隔）：$\Delta\mu=\frac{1}{M\Delta}=\frac{1}{T}$
- 跨越的频率范围：$\Omega=M\Delta\mu=\frac{1}{\Delta T}$

设有一个由连续函数$f(t)$的$M$个样本组成的集合$\{f_n\}$或${f(x)|x=0,1,…,M−1}$，其对应的$M$个离散傅里叶变换的值的样本集合为$\{F_m\}$或${F(μ)|μ=0,1,…,M−1}$。**离散傅里叶变换对**适用于任何均匀取样的有限离散样本集。

- DFT

    $$
    F_m=\sum_{n=0}^{M-1}{f_ne^{-j2\pi mn/M}}, \quad m=0,1,2,\cdots,M-1
    $$

    $$
    F(\mu)=\sum_{x=0}^{M-1}{f(x)e^{-j2\pi \mu x/M}}, \quad \mu=0,1,2,\cdots,M-1
    $$

- IDFT：
    $$
    f_{n}=\frac{1}{M} \sum_{m=0}^{M-1} F_{m} \mathrm{e}^{\mathrm{j} 2 \pi m n / M}, \quad n=0,1,2, \cdots, M-1
    $$

    $$
    f(x)=\frac{1}{M} \sum_{\mu=0}^{M-1} F(\mu) \mathrm{e}^{\mathrm{j} 2 \pi \mu x / M}, \quad x=0,1,2, \cdots, M-1
    $$

**离散卷积公式**：由于函数是周期的，所以它们的卷积也是周期的，下式也给出了周期卷积的一个周期。
$$
f(x) \circledast h(x)=\sum_{m=0}^{M-1} f(m) h(x-m), \quad x=0,1,2, \ldots, M-1
$$

## 二维拓展

